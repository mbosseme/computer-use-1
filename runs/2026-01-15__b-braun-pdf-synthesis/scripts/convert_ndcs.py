#!/usr/bin/env python3
"""Convert hyphenated NDCs to 11-digit format for TAE matching."""

from pathlib import Path

ndcs_hyphenated = [
    "63323-626-50", "63323-626-00", "63323-626-25", "63323-626-55", "63323-626-10",
    "65219-466-60", "65219-468-50", "65219-470-30", "65219-472-20", "65219-474-10",
    "65219-218-50", "65219-220-10", "65219-222-25", "65219-224-50", "65219-502-10",
    "65219-504-20", "65219-506-30", "63323-824-74", "63323-824-75", "63323-824-76",
    "63323-530-75", "65219-456-60", "65219-464-50", "65219-458-30", "65219-460-20",
    "65219-462-10", "65219-234-10", "65219-236-10", "65219-238-25", "65219-240-50",
    "65219-258-10", "65219-243-50", "65219-241-10", "63323-870-10", "63323-870-74",
    "63323-869-75", "63323-869-74", "63323-869-10", "63323-873-75", "63323-873-74",
    "63323-873-10", "63323-867-74", "63323-867-10", "65219-475-30", "65219-477-20",
    "65219-479-10", "65219-389-05", "65219-389-10", "63323-667-10", "63323-669-10",
    "65219-118-10", "65219-119-10", "65219-153-10", "65219-150-75", "65219-142-10",
    "65219-144-10", "65219-146-10", "65219-148-10", "65219-246-10", "63323-683-10",
    "63323-686-10", "63323-688-10", "65219-004-01", "65219-008-51", "65219-012-01",
    "65219-006-01", "65219-010-01", "63323-178-76", "65219-495-10", "65219-497-20",
    "65219-499-30"
]

def main():
    ndcs_11digit = []
    for ndc in ndcs_hyphenated:
        parts = ndc.split('-')
        labeler = parts[0]  # 5 digits
        product = parts[1].zfill(4)  # pad to 4 digits
        package = parts[2].zfill(2)  # pad to 2 digits
        ndc_11 = labeler + product + package
        ndcs_11digit.append(ndc_11)
        print(f"{ndc:15} -> {ndc_11}")

    # Save to file
    out_path = Path(__file__).parent.parent / 'tmp' / 'jen_ndcs_11digit.txt'
    with open(out_path, 'w') as f:
        for ndc in ndcs_11digit:
            f.write(ndc + '\n')
    print(f"\nSaved {len(ndcs_11digit)} 11-digit NDCs to {out_path}")
    
    # Print SQL-ready list
    print("\n\nSQL-ready list:")
    sql_list = ", ".join([f"'{ndc}'" for ndc in ndcs_11digit])
    print(sql_list)

if __name__ == "__main__":
    main()
